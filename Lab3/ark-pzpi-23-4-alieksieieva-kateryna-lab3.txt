МІНІСТЕРСТВО ОСВІТИ І НАУКИ УКРАЇНИ

ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ
УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ
 
 
 
 
 
 
 
ЗВІТ
з дисципліни «Аналіз та рефакторинг коду»
Лабораторна робота №3
 РОЗРОБКА БІЗНЕС-ЛОГІКИ ТА ФУНКЦІЙ АДМІНІСТРУВАННЯ СЕРВЕРНОЇ ЧАСТИНИ ПРОГРАМНОЇ СИСТЕМИ
 
 
 
Виконала:   	 	 	 	 	                  Перевірил:
ст. гр. ПЗПІ-23-4   	 	 	 	                  старший викладач каф. ПІ
Алєксєєва К.С.   	 	 	 	                  Сокорчук І.П.
 
 
 

 
 
 
 

ХАРКІВ 2025

1.	ІСТОРІЯ ЗМІН

№	Дата	Версія звіту	Опис змін та виправлень
1	17.12.2025	0.1	Створено звіт




















2.	ЗАВДАННЯ

На лабораторній роботі №3 потрібно розробити бізнес-логику та функції адміністрування серверної частини  програмної системи 
Завдання:
1.	Розробити бізнес логіку серверної частини програмної системи.
2.	Розробити функції адміністрування серверної частини програмної системи.
3.	Створити програмну реалізацію бізнес логіки та функцій адміністрування серверної частини.
4.	Перевірити роботу серверної частини системи.
5.	Завантажити або оновити (при потребі) створений програмний код у GitHub репозиторій для лабораторних робіт у гілку репозиторію main.
6.	Створити відеозапис демонстрації описаної у розділі 3.1 Vision & Scope функціональності серверної частини та завантажити цей відеозапис у свій канал на YouTube для облікового запису в домені @nure.ua.  При завантаженні відеозапису потрібно обовʼязково встановити у налаштуваннях для цього відео українську мову як мову відео та мову субтитрів до відео.
7.	Створити хронологічний опис (хвилина:секунда) демонстрації та додати цей опис до опису відео.
8.	Створити звіт до лабораторної роботи.
9.	Експортувати створений звіт у формат PDF та завантажити його на платформу dl.nure.ua.
10.	Експортувати увесь створений звіт у простий текстовий файл з кодуванням UTF-8 та записати цей файл у GitHub репозиторій для лабораторних робіт з вказаним у цих методичних вказівках іменем файла та директорії.

3. ОПИС ВИКОНАНОЇ РОБОТИ
3.1 Реалізація функцій адміністрування серверної частини
Розроблена серверна частина програмної системи призначена для керування підписками, бізнес-шаблонами та використанням компонентів у межах IoT-орієнтованої системи. Серверна частина забезпечує обробку бізнес-даних, контроль доступу та виконання адміністративних операцій через REST API. 
Бізнес-логіка серверної частини реалізує основні процеси обробки даних, пов’язані з підписками користувачів та використанням сервісних компонентів.
До бізнес-логіки системи належать:
•	визначення активних підписок для конкретного бізнесу або IoT-пристрою;
•	облік використання компонентів підписки;
•	збільшення лічильників використання компонентів;
•	перевірка статусу підписок та компонентів.
usage.setUsedCount(usage.getUsedCount() + 1);
componentUsageRepository.save(usage);
Фрагмент коду 2.1 - Обробка використання компонента підписки(код)
Даний фрагмент реалізує математичну операцію інкременту лічильника використання компонента, що є основою обліку споживання сервісів.
3.2 Реалізація функцій адміністрування серверної частини
Функції адміністрування забезпечують керування конфігураціями системи та доступом до неї. Адміністративна логіка реалізована з використанням рольової моделі доступу.
До функцій адміністрування належать:
•	створення шаблонів підписок для бізнесу;
•	керування компонентами підписок;
•	контроль доступу на основі ролей користувачів;
•	автентифікація та авторизація за допомогою JWT.

@PreAuthorize("hasRole('BUSINESS')")
@PostMapping("/create")
public SubscriptionTemplateResponse createTemplate(...) { ... }
Фрагмент коду 2.2 – Створення шаблону підписки
Даний фрагмент забезпечує обмеження доступу до адміністративної функції створення шаблону підписки лише для користувачів із роллю BUSINESS.
У системі реалізовано рольову модель доступу, що визначає функціональні можливості кожного користувача:
public enum UserRoles {
    ADMIN,
    CLIENT,
    BUSINESS
}
Фрагмент коду 2.3 – Ролі у системі
ADMIN — має повний доступ до системи, може керувати користувачами, бізнесами та підписками.
BUSINESS — представляє бізнес-сторону системи, створює та керує шаблонами підписок і компонентами.
СLIENT — кінцевий користувач, який оформлює підписки та використовує сервіси відповідно до умов підписки.
3.3 Бізнес-логіка управління підписками серверної частини системи
Бізнес-логіка серверної частини програмної системи орієнтована на управління підписками, які визначають правила доступу користувачів до сервісів та компонентів, що надаються бізнесом. Центральним елементом цієї логіки є механізм створення, активації та використання підписок із чітким розмежуванням ролей і відповідальностей між учасниками системи.
Зі сторони бізнесу реалізовано механізм формування шаблонів підписок. Бізнес-користувач має можливість створювати шаблони підписок, у яких визначаються базова вартість, тривалість дії, опис та початковий статус. Кожен шаблон підписки прив’язується до конкретного бізнесу, що унеможливлює несанкціоноване керування підписками сторонніми користувачами. Шаблон підписки виступає основою для подальшого оформлення підписок клієнтами.
Важливою складовою бізнес-логіки є механізм активації підписок. Після створення шаблон підписки може бути переведений у активний стан. Лише активні підписки стають доступними для оформлення клієнтами. Такий підхід дозволяє бізнесу контролювати момент запуску сервісу та запобігає випадковому використанню ще неготових тарифів.
Кожна підписка може містити набір компонентів, які описують окремі сервіси або можливості. Для кожного компонента задається тип, ліміт використання та можливий модифікатор ціни. Це дозволяє гнучко формувати тарифи та адаптувати підписки під різні бізнес-моделі. Компоненти є складовими шаблону підписки та не можуть існувати незалежно від нього.
Зі сторони користувача бізнес-логіка реалізує процес оформлення підписки на основі обраного шаблону. Після оформлення створюється індивідуальна підписка користувача, яка містить інформацію про бізнес, шаблон, дати початку та завершення дії, фінальну вартість та статус. Таким чином забезпечується чітке відокремлення шаблонів підписок від конкретних підписок користувачів.
Для контролю використання сервісів у межах підписки реалізовано механізм обліку використання компонентів. Для кожної пари «підписка користувача – компонент» зберігається лічильник використань. Під час кожної взаємодії з сервісом система збільшує відповідний лічильник та перевіряє, чи не перевищено встановлений ліміт. Це забезпечує дотримання умов підписки та запобігає зловживанню сервісами.
Окремим елементом бізнес-логіки є інтеграція з IoT-пристроями. Для кожного пристрою формується конфігурація, яка містить інформацію про активні підписки та доступні компоненти. Пристрої надсилають дані про використання сервісів, що дозволяє системі вести журнал подій та коректно оновлювати статистику використання.
Адміністративна бізнес-логіка передбачає можливість контролю стану підписок, користувачів та компонентів. Адміністратор має доступ до інформації про підписки, може здійснювати моніторинг використання сервісів та забезпечувати коректну роботу системи в цілому. Розмежування ролей дозволяє забезпечити безпеку та прозорість бізнес-процесів.
Таким чином, реалізована бізнес-логіка підписок забезпечує повний цикл керування сервісами — від створення тарифів бізнесом до контролю фактичного використання сервісів користувачами. Запропонований підхід відповідає вимогам масштабованості, безпеки та підтримуваності серверної частини програмної системи.

 
Рисунок 3.1 - UML-діаграма взаємодії створення шаблону підписки
 
Рисунок 3.2 - UML діаграма взаємодії активації шаблону підписки

 
Рисунок 3.3 - UML діаграма взаємодії оформлення підписки користувачем
 
Рисунок 3.4 - UML діаграма взаємодії обліку використання компонентів підписки

 
Рисунок 3.5 - UML-діаграма взаємодії отримання конфігурації IoT-пристрою	



1. Загальна характеристика бізнес-логіки формування підписок
Бізнес-логіка системи підписок реалізує процес створення, керування та використання підписок у межах конкретного бізнесу. Система підтримує роботу з шаблонами підписок, компонентами підписок, індивідуальними підписками користувачів, а також контроль використання сервісів і адміністрування бізнес-об’єктів.
Формування підписки базується на активному шаблоні підписки, який визначає базову вартість, тривалість дії та набір компонентів. Кінцева вартість підписки обчислюється з урахуванням модифікаторів ціни компонентів. Для кожного користувача створюється окрема сутність підписки з власним періодом дії та обліком використання компонентів.

2. Основні бізнес-функції роботи з шаблонами підписок
2.1 Пошук шаблону підписки за ідентифікатором
Метод findById забезпечує отримання шаблону підписки за його ідентифікатором. У разі відсутності шаблону в базі даних генерується виняткова ситуація, що запобігає подальшій некоректній обробці даних.
2.2 Створення шаблону підписки
Метод create реалізує бізнес-функцію створення нового шаблону підписки для конкретного бізнесу. Під час створення визначаються назва, опис, базова ціна та тривалість дії підписки. Новостворений шаблон автоматично переводиться в активний стан та зберігається в базі даних.


2.3 Отримання шаблонів бізнесу
Метод findByBusinessId забезпечує отримання списку всіх шаблонів підписок, що належать конкретному бізнесу. Ця функція використовується для відображення доступних тарифних планів у системі адміністрування.
2.4 Отримання активного шаблону
Метод getActiveTemplate реалізує перевірку доступності шаблону для оформлення підписки. Метод повертає лише ті шаблони, які мають статус ACTIVE, що гарантує дотримання бізнес-правил.
2.5 Зміна статусу шаблону
Метод changeStatus забезпечує зміну статусу шаблону підписки (активація або деактивація). Ця операція використовується для керування життєвим циклом тарифних планів.

3. Бізнес-функції адміністрування системи
3.1 Модерація бізнесу
Метод moderateBusiness, доступний лише користувачам з роллю ADMIN, реалізує функцію адміністративної перевірки бізнесу. Адміністратор передає рішення щодо бізнесу, після чого система змінює стан верифікації бізнес-сутності.
Ця функція забезпечує контроль якості та безпеки бізнес-об’єктів у системі.

4. Бізнес-логіка використання компонентів підписки
4.1 Ініціалізація використання компонентів
Метод initUsage виконує ініціалізацію обліку використання компонентів для новоствореної підписки користувача. Для кожного компонента створюється запис із нульовим лічильником використань, що дозволяє надалі контролювати дотримання встановлених лімітів.
Операція виконується в межах транзакції, що гарантує цілісність даних.

5. Бізнес-логіка оформлення підписки користувачем
5.1 Створення підписки користувача
Метод createUserSubscription реалізує повний бізнес-процес оформлення підписки. Спочатку система отримує користувача та активний шаблон підписки. Далі визначається бізнес, якому належить шаблон, та перелік компонентів підписки.
На основі базової ціни шаблону та модифікаторів ціни компонентів обчислюється фінальна вартість підписки. Після цього формується період дії підписки, створюється сутність підписки користувача та зберігається в базі даних. Завершальним етапом є ініціалізація обліку використання компонентів.
5.2 Обчислення фінальної вартості
Метод calculateFinalPrice реалізує математичну бізнес-функцію розрахунку фінальної ціни підписки. До базової вартості шаблону послідовно додаються цінові модифікатори всіх компонентів, що входять до підписки.

6. Отримання статистики бізнесу
Метод getBusinessStatistics забезпечує формування агрегованої статистики щодо підписок конкретного бізнесу. Ця інформація використовується для аналітики, оцінки прибутковості та прийняття управлінських рішень.


4. ВИСНОВКИ
У ході лабораторної роботи №3 було розроблено та реалізовано бізнес-логіку серверної частини програмної системи, що забезпечує обробку даних підписок та облік використання компонентів. Також реалізовано функції адміністрування, які дозволяють керувати шаблонами підписок і контролювати доступ до системи на основі ролей. Програмна реалізація відповідає вимогам масштабованості, безпеки та логічної цілісності серверної частини.










5. ВИКОРИСТАНІ ДЖЕРЕЛА
1.	ISO/IEC/IEEE 29148:2018. Systems and software engineering — Life cycle processes — Requirements engineering. Geneva, Switzerland: ISO/IEC, 2018.
2.	ДСТУ 8302:2015. Інформація та документація. Бібліографічне посилання. Загальні положення та правила складання. Київ: ДП «УкрНДНЦ», 2015.
3.	Fowler, M. Patterns of Enterprise Application Architecture. Addison-Wesley Professional, 2002.
4.	Офіційна документація фреймворку Spring Boot (версія 3.x). URL: https://spring.io/projects/spring-boot





















ДОДАТОК А
Відеозапис
Відеозапис 
Відеозапис презентації результатів лабораторної роботи: 
Хронологічний опис відеозапису:
00:00 – Вступ
00:13 – Аналіз проблеми
01:55 – Аналіз аналогів
02:56 – Опис призначення системи
03:44 – Опис бізнес-логіки
05:32 – Опис функціональності серверної частини та IoT-клієнта
07:20 – Опис функціональності веб-клієнта та мобільного клієнта
08:47 – Опис програмних засобів та інструментів

	











ДОДАТОК Б
Програмний код
@Transactional
public UserSubscriptionResponse createUserSubscription(CreateUserSubscriptionRequest request) {

    UserEntity user = userService.findUserById(request.userId());

    SubscriptionTemplateEntity template = subscriptionTemplateService.getActiveTemplate(request.templateId());

    BusinessEntity business = template.getBusiness();

    List<SubscriptionComponentEntity> components =
            subscriptionComponentService.findByTemplateId(template.getId());

    BigDecimal finalPrice = template.getBasePrice();
    for (SubscriptionComponentEntity component : components) {
        if (component.getPriceModifier() != null) {
            finalPrice = finalPrice.add(component.getPriceModifier());
        }
    }

    LocalDateTime startDate = LocalDateTime.now();
    LocalDateTime endDate = startDate.plusDays(template.getDurationDays());

    UserSubscriptionEntity subscription = userSubscriptionService.create(
            user,
            business,
            template,
            startDate,
            endDate,
            finalPrice
    );


    componentUsageService.initUsage(subscription, components);

    return userSubscriptionMapper.toDto(subscription);
}
Б.2 – moderate business
public void moderateBusiness(ModerateBusinessRequest moderateBusinessrequest){
 BusinessEntity entity = businessService.findById(moderateBusinessrequest.businessId());
    businessService.verifyBusiness(entity, moderateBusinessrequest.businessValue());
}
Б.3 – moderate business
@Transactional
public SubscriptionTemplateResponse createTemplate(CreateSubscriptionTemplateRequest request) {
    BusinessEntity business = businessService.findById(request.businessId());

    SubscriptionTemplateEntity template =
            subscriptionTemplateService.create(
                    business,
                    request.name(),
                    request.description(),
                    request.basePrice(),
                    request.durationDays()
            );

    return templateMapper.toDto(template);
}





